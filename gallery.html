<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" >
    <meta http-equiv="X-UA-Compatible" content="IE=edge" >
    <title>Gallery Page</title>
    <meta name="description" content="" >
    <meta name="viewport" content="width=device-width, initial-scale=1" >
     <!-- Add this line to load Material Icons -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet" />

    <link rel="stylesheet" href="codered.css" >
</head>
<body>
    <!-- Canvas for background animation -->
    <canvas id="background-canvas" aria-hidden="true"></canvas>

<!-- Floating Soviet-style Icon Menu -->
<div class="floating-container" aria-label="Accessibility and contact menu" role="navigation">
  <div class="floating-button" aria-expanded="false" aria-controls="floatingMenu" aria-label="Toggle menu">+</div>
  <div class="element-container" id="floatingMenu">
    <!-- Removed phone and email buttons -->
    <a href="form.html" title="Chat" aria-label="Chat">
      <span class="float-element"><i class="material-icons">chat</i></span>
    </a>
    <button class="float-element" onclick="toggleHighContrastMode()" title="Toggle High Contrast Mode" aria-pressed="false" id="highContrastToggle" aria-label="Toggle High Contrast Mode">
      <i class="material-icons">invert_colors</i>
    </button>
    <button class="float-element" onclick="toggleExtraReadableFont()" title="Toggle Extra Readable Font" aria-pressed="false" id="readableFontToggle" aria-label="Toggle Extra Readable Font">
      <i class="material-icons">format_size</i>
    </button>
  </div>
</div>



    <!-- Loading screen -->
    <section class="LoadingScreen" role="status" aria-live="polite" aria-label="Loading content">
        <div class="spinner" aria-hidden="true">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </section>

    <!-- Explicit Content Warning -->
    <div id="blur-overlay" class="blur-overlay" role="dialog" aria-hidden="true"></div>
    <div id="explicit-warning" class="explicit-popup" role="alertdialog" aria-labelledby="warning-title" aria-describedby="warning-desc">
        <h2 id="warning-title" class="sr-only">Content Warning</h2>
        <p id="warning-desc">This gallery contains content some users may find disturbing or explicit. (R-15)</p>
        <div class="popup-buttons">
            <button onclick="proceedToGallery()" aria-label="Proceed to gallery">I Understand, Proceed</button>
            <button onclick="stayOnLanding()" aria-label="Return to previous page">Take Me Back</button>
        </div>
    </div>

    <!-- Main content -->
    <main class="gallery">
        <section class="gallery-content" aria-label="Image gallery slideshow">
            <div class="slide-show-container">

        <div class="mySlides fade">
            <figure>
            <img src="Pictures/hallwayshot.jpg" alt="This image depicts a hallway leading to the exit of a building. It shows a long corridor with walls and a door at the end." >
            <figcaption class="image-info">
                <span class="numberText">1/6</span>
                <span class="Caption">Hallway to the exit</span>
                <time class="productionDate" datetime="1976-01-01">1976/1/1</time>
            </figcaption>
            </figure>
        </div>


        <div class="mySlides fade">
            <figure>
            <div class="numberText">2/6</div>
            <img src="Pictures/glassjarshot.jpg" alt="This image depicts a glass jar filled with blood. It is a close-up shot that highlights the jar's intricate details and the rich color of the liquid inside." >
            <figcaption>
                <span class="Caption">Glass Jar with Blood</span>
                <time class="productionDate" datetime="1976-05-15">1976/5/15</time>
            </figcaption>
            </figure>
        </div>

                <div class="mySlides fade">
                    <figure>
                    <div class="numberText">3/6</div>
                    <img src="Pictures/tableshot.jpg" alt="This image depicts the table at which some rusted scalpels lay on top." >
                    <figcaption>
                        <span class="Caption">Table adorned with scalpels.</span>
                        <time class="productionDate" datetime="1976-03-10">1976/3/10</time>
                    </figcaption>
                    </figure>
                </div>

                <div class="mySlides fade">
                    <figure>
                    <div class="numberText">4/6</div>
                    <img src="Pictures/lowshotofglassjars.jpg" alt="This image depicts a low-angle shot of glass jars filled with various liquids. The focus is on the intricate details of the jars and the vibrant colors of the liquids." >
                    <figcaption>
                        <span class="Caption">Low Shot of Glass Jars</span>
                        <time class="productionDate" datetime="1976-07-20">1976/7/20</time>
                    </figcaption>
                    </figure>
                </div>

                <div class="mySlides fade">
                    <figure>
                    <div class="numberText">5/6</div>
                    <img src="Pictures/lamp+jarshot.jpg" alt="This image depics a picture of an industrial lamp. It is a close-up shot that highlights the lamp's design and the glass jar beside it." > 
                    <figcaption>
                        <span class="Caption">Industrial Lamp</span>
                        <time class="productionDate" datetime="1976-02-14">1976/2/14</time>
                    </figcaption>
                    </figure>
                </div>

                <div class="mySlides fade">
                    <figure>
                    <div class="numberText">6/6</div>
                    <img src="Pictures/scalpelshot.jpg" alt="This image depicts a rusted scalped sitting on top of one of the old beaten-up tables." >
                    <figcaption>
                        <span class="Caption">Rusted Scalpel</span>
                        <time class="productionDate" datetime="1976-08-30">1976/8/30</time>
                    </figcaption>
                    </figure>
                </div>

                <!-- Navigation buttons for slideshow -->
                <button class="prev" aria-label="Previous slide" onclick="plusSlides(-1)">&#10094;</button>
                <button class="next" aria-label="Next slide" onclick="plusSlides(1)">&#10095;</button>
            </div>

            <!-- Slide indicator dots -->
            <nav aria-label="Slideshow navigation" style="text-align:center; margin-top: 20px;">
                <button class="dot" onclick="currentSlide(1)" title="Image 1" aria-label="Go to slide 1"></button>
                <button class="dot" onclick="currentSlide(2)" title="Image 2" aria-label="Go to slide 2"></button>
                <button class="dot" onclick="currentSlide(3)" title="Image 3" aria-label="Go to slide 3"></button>
                <button class="dot" onclick="currentSlide(4)" title="Image 4" aria-label="Go to slide 4"></button>
                <button class="dot" onclick="currentSlide(5)" title="Image 5" aria-label="Go to slide 5"></button>
                <button class="dot" onclick="currentSlide(6)" title="Image 6" aria-label="Go to slide 6"></button>
            </nav>
        </section>
    </main>

    <!-- Navigation bar -->
    <nav class="navbar" aria-label="Primary site navigation">
        <ul class="nav-links">
            <li><a href="index.html" onclick="return !isCurrentPage('index.html')">Landing</a></li>
            <li><a href="trailer.html" onclick="return !isCurrentPage('trailer.html')">Trailer</a></li>
            <li><a href="aboutus.html" onclick="return !isCurrentPage('aboutus.html')">About</a></li>
            <li><a href="pricing.html" onclick="return !isCurrentPage('pricing.html')">Pricing</a></li>
            <li><a href="gallery.html" onclick="return !isCurrentPage('gallery.html')">Gallery</a></li>
        </ul>
    </nav>

    <script>
        // Explicit content warning functions
        function showExplicitWarning(event) {
            event.preventDefault();
            const warning = document.getElementById('explicit-warning');
            const overlay = document.getElementById('blur-overlay');
            warning.style.display = 'block';
            overlay.style.display = 'block';
            warning.setAttribute('aria-hidden', 'false');
            overlay.setAttribute('aria-hidden', 'false');
            
            // Trap focus within the warning dialog
            const focusableElements = warning.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');
            const firstFocusableElement = focusableElements[0];
            const lastFocusableElement = focusableElements[focusableElements.length - 1];
            
            // Focus the first button
            firstFocusableElement.focus();
            
            // Handle keyboard navigation
            function handleTab(e) {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        if (document.activeElement === firstFocusableElement) {
                            e.preventDefault();
                            lastFocusableElement.focus();
                        }
                    } else {
                        if (document.activeElement === lastFocusableElement) {
                            e.preventDefault();
                            firstFocusableElement.focus();
                        }
                    }
                }
                if (e.key === 'Escape') {
                    stayOnLanding();
                }
            }
            
            warning.addEventListener('keydown', handleTab);
            return false;
        }

        function proceedToGallery() {
            const hasAccepted = localStorage.getItem('galleryWarningAccepted');
            if (!hasAccepted) {
                localStorage.setItem('galleryWarningAccepted', 'true');
            }
            document.getElementById('explicit-warning').style.display = 'none';
            document.getElementById('blur-overlay').style.display = 'none';
        }

        function stayOnLanding() {
            window.location.href = 'index.html';
        }

        // Check if user has already accepted the warning
        document.addEventListener('DOMContentLoaded', () => {
            const hasAccepted = localStorage.getItem('galleryWarningAccepted');
            if (!hasAccepted) {
                showExplicitWarning({ preventDefault: () => {} });
            }
        });

        // Wrap letters for animation effect on given selectors
        function wrapLetters(selector, delayIncrement = 0.3) {
            const el = document.querySelector(selector);
            if (!el) return;
            const text = el.textContent;
            el.innerHTML = '';
            [...text].forEach((char, index) => {
                const span = document.createElement('span');
                span.textContent = char;
                if (char === ' ') {
                    span.classList.add('space');
                }
                const floatDelay = (index * delayIncrement).toFixed(2);
                span.style.animation = `flicker 3s infinite ease-in-out 0s, floatSingle 4.5s infinite cubic-bezier(0.4, 0, 0.2, 1) ${floatDelay}s`;
                el.appendChild(span);
            });
        }

        // Apply text animations to info page elements
        wrapLetters('.gallery-inner');
        wrapLetters('.gallery-item');

        // Loading screen logic
        const currentPage = window.location.pathname.split('/').pop();
        const loadingScreen = document.querySelector('.LoadingScreen');
        const loadingContent = document.querySelector('.loading-content-inner');

        // Show loading screen only for actual page transitions
        if (document.referrer === '' || !document.referrer.includes(currentPage)) {
            loadingScreen.style.display = 'flex';
        } else {
            loadingScreen.style.display = 'none';
        }

        // Hide loading screen on load after delay
        window.addEventListener('load', () => {
            if (loadingScreen.style.display === 'flex') {
                setTimeout(() => {
                    loadingScreen.style.opacity = '0';
                    setTimeout(() => {
                        loadingScreen.style.display = 'none';
                    }, 1000);
                }, 2000);
            }
        });

        // Fallback timeout to hide loading screen
        setTimeout(() => {
            if (loadingScreen.style.display === 'flex') {
                loadingScreen.style.opacity = '0';
                setTimeout(() => {
                    loadingScreen.style.display = 'none';
                }, 1000);
            }
        }, 5000);

        // Check if href matches current page
        function isCurrentPage(href) {
            return window.location.pathname.endsWith(href);
        }

        // Slideshow functionality
        let slideIndex = 1;
        function plusSlides(n) {
            showSlides(slideIndex += n);
        }
        function currentSlide(n) {
            showSlides(slideIndex = n);
        }
        function showSlides(n) {
            let slides = document.getElementsByClassName("mySlides");
            let dots = document.getElementsByClassName("dot");

            if (n > slides.length) {
                slideIndex = 1;
            }
            if (n < 1) {
                slideIndex = slides.length;
            }

            for (let i = 0; i < slides.length; i++) {
                slides[i].style.display = "none";
                slides[i].style.opacity = "0";
            }

            for (let i = 0; i < dots.length; i++) {
                dots[i].className = dots[i].className.replace(" active", "");
            }

            slides[slideIndex - 1].style.display = "block";
            setTimeout(() => {
                slides[slideIndex - 1].style.opacity = "1";
            }, 10);
            dots[slideIndex - 1].className += " active";
        }

        // Initialize slideshow on page load
        showSlides(slideIndex);

        // Keyboard navigation for slideshow
        document.addEventListener('keydown', (event) => {
            if (event.key === 'ArrowLeft') {
                plusSlides(-1);
            } else if (event.key === 'ArrowRight') {
                plusSlides(1);
            }
        });

       const floatingButton = document.querySelector('.floating-button');
const floatingMenu = document.getElementById('floatingMenu');

floatingButton.addEventListener('click', (e) => {
  e.stopPropagation(); // Prevent event bubbling
  const isShown = floatingMenu.classList.toggle('show');
  floatingButton.setAttribute('aria-expanded', isShown);
});

// Close floating menu when clicking outside
document.addEventListener('click', (e) => {
  if (!floatingMenu.contains(e.target) && !floatingButton.contains(e.target)) {
    floatingMenu.classList.remove('show');
    floatingButton.setAttribute('aria-expanded', 'false');
  }
});


function stayOnLanding() {
  const warning = document.getElementById('explicit-warning');
  const overlay = document.getElementById('blur-overlay');

  warning.style.display = 'none';
  overlay.classList.remove('active'); // Hide blur overlay

  warning.setAttribute('aria-hidden', 'true');
  overlay.setAttribute('aria-hidden', 'true');
}

function proceedToGallery() {
  localStorage.setItem('galleryWarningAccepted', 'true');
  document.getElementById('explicit-warning').style.display = 'none';
  document.getElementById('blur-overlay').classList.remove('active'); // Hide blur overlay
  window.location.href = 'gallery.html';
}


  function toggleHighContrastMode() {
  const body = document.body;
  const isActive = body.classList.toggle('high-contrast-mode');
  localStorage.setItem('highContrastMode', isActive ? 'true' : 'false');

  // Update aria-pressed on the button for accessibility
  const btn = document.getElementById('highContrastToggle');
  if (btn) btn.setAttribute('aria-pressed', isActive);
}

function toggleExtraReadableFont() {
  const body = document.body;
  const isActive = body.classList.toggle('extra-readable-font');
  localStorage.setItem('extraReadableFont', isActive ? 'true' : 'false');

  const btn = document.getElementById('readableFontToggle');
  if (btn) btn.setAttribute('aria-pressed', isActive);
}


        // Apply saved accessibility preferences on DOMContentLoaded
        document.addEventListener('DOMContentLoaded', () => {
            const savedFont = localStorage.getItem('extraReadableFont');
            if (savedFont === 'true') {
                document.body.classList.add('extra-readable-font');
                document.getElementById('extraReadableFont').checked = true;
            }

            const savedContrast = localStorage.getItem('highContrastMode');
            if (savedContrast === 'true') {
                document.body.classList.add('high-contrast-mode');
                document.getElementById('highContrastMode').checked = true;
            }
        });

        // Background canvas particle animation
        const canvas = document.getElementById('background-canvas');
        const ctx = canvas.getContext('2d');
        let width = window.innerWidth;
        let height = window.innerHeight;
        canvas.width = width;
        canvas.height = height;
        canvas.style.position = 'fixed';
        canvas.style.top = 0;
        canvas.style.left = 0;
        canvas.style.zIndex = '1'; // Above background but below content
        canvas.style.width = '100vw';
        canvas.style.height = '100vh';
        canvas.style.pointerEvents = 'none';

        const particles = [];
        const particleCount = 60;
        for (let i = 0; i < particleCount; i++) {
            particles.push({
                x: Math.random() * width,
                y: Math.random() * height,
                r: 1 + Math.random() * 2,
                dx: -0.5 + Math.random(),
                dy: -0.5 + Math.random(),
                alpha: 0.1 + Math.random() * 0.3
            });
        }

        function animate() {
            ctx.clearRect(0, 0, width, height);
            for (let p of particles) {
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.r, 0, 2 * Math.PI);
                ctx.fillStyle = `rgba(166, 136, 109, ${p.alpha})`;
                ctx.shadowColor = '#A6886D';
                ctx.shadowBlur = 8;
                ctx.fill();
                p.x += p.dx;
                p.y += p.dy;
                if (p.x < 0 || p.x > width) p.dx *= -1;
                if (p.y < 0 || p.y > height) p.dy *= -1;
            }
            requestAnimationFrame(animate);
        }
        animate();

        window.addEventListener('resize', () => {
            width = window.innerWidth;
            height = window.innerHeight;
            canvas.width = width;
            canvas.height = height;
        });
    </script>
</body>
</html>
